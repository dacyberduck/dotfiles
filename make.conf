# These settings were set by the catalyst build script that automatically
# built this stage.
# Please consult /usr/share/portage/config/make.conf.example for a more
# detailed example.
TARGET_CPU="skylake"
NTHREADS="8"

# WARNING: Changing your CHOST is not something that should be done lightly.
# Please consult https://wiki.gentoo.org/wiki/Changing_the_CHOST_variable before changing.
CHOST="x86_64-gentoo-linux-musl"
CXXSTDLIB="c++"

COMMON_FLAGS="-march=${TARGET_CPU} -O3 -pipe -mllvm -polly -mllvm -polly-vectorizer=stripmine -flto=thin"
CFLAGS="${COMMON_FLAGS}"
CXXFLAGS="${COMMON_FLAGS}"
FCFLAGS="${COMMON_FLAGS}"
FFLAGS="${COMMON_FLAGS}"
RUSTFLAGS="-Ctarget-cpu=${TARGET_CPU} -Copt-level=3 -Ccodegen-units=${NTHREADS} -Cllvm-args=--polly -Cllvm-args=--polly-vectorizer=stripmine"
LDFLAGS="-flto=thin -Wl,-O2 -Wl,--as-needed"

MAKEOPTS="-j${NTHREADS}"
NINJAOPTS="-j${NTHREADS}"
CMAKE_MAKEFILE_GENERATOR="ninja"

# USE flags
USE="openrc seatd -elogind -systemd -consolekit -policykit -pam \
     dbus udev zstd ffmpeg sdl clang \
     wayland egl eglfs gles1 gles2 gles3 drm libdrm -X -opengl \
     alsa pipewire pipewire-alsa gstreamer -pulseaudio \
     png jpeg gif svg \
     mp3 aac flac ogg vorbis \
     mp4 matroska x264 x265 v4l openh264 opus bluray libaom \
     -gnome -gtk -gtk4 -qt4 -qt5-notification -libnotify -doc -xv"

# portage options
ACCEPT_KEYWORDS="~amd64"
ACCEPT_LICENSE="@FREE"
#EMERGE_DEFAULT_OPTS="--ask --verbose --autounmask --usepkg -j${NTHREADS} -l${NTHREADS}"
EMERGE_DEFAULT_OPTS="--ask --verbose --autounmask"
PORTAGE_NICENESS=15
FEATURES="sandbox"

# hardware settings
INPUT_DEVICES="libinput"
VIDEO_CARDS="intel i965 iris"
CPU_FLAGS_X86="aes avx avx2 f16c fma3 mmx mmxext pclmul popcnt rdrand sse sse2 sse3 sse4_1 sse4_2 ssse3"

# libraries
LUA_TARGETS="luajit"
LUA_SINGLE_TARGET="luajit"
RUBY_TARGETS="ruby30"
PYTHON_TARGETS="python3_9"
PYTHON_SINGLE_TARGET="python3_9"

# NOTE: This stage was built with the bindist Use flag enabled
PORTDIR="/var/db/repos/gentoo"
DISTDIR="/var/cache/distfiles"
PKGDIR="/var/cache/binpkgs"

# This sets the language of build output to English.
# Please keep this setting intact when reporting bugs.
LC_MESSAGES=C

GENTOO_MIRRORS="https://mirror.yandex.ru/gentoo-distfiles/"
